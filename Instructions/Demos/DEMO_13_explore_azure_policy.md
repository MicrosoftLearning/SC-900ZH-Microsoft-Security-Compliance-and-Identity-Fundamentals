---
Demo:
    title: 'Azure Policy'
    module: '模块 4 第 5 课：描述 Microsoft 合规性解决方案的功能：描述 Azure Policy'
---


# 演示：Azure Policy

### 演示方案
在本演示中，你将演练设置 Azure 策略的过程以及该策略的影响。

#### 演示第 1 部分：创建一个“要求资源组上带有标记”策略（显示根据模板创建策略的步骤）

1. 打开 Microsoft Edge。在地址栏中，输入“**portal.microsoft.com**”。  你应该已经登录；如果未登录，请使用管理员凭据进行登录。

1. 在页面顶部显示 Microsoft Azure 旁边蓝色栏的搜索框中，输入“**策略**”，然后在搜索结果中选择“**策略**”。

1. 现在位于“**策略**”页面的概述部分。请注意仪表板中提供的信息。

1. 在左侧导航面板的“创作”下，选择“**分配**”。  你将看到已经有一个策略分配，请选择“**ASC 默认**”。  查看说明字段。备注：说明字段引用 Azure 安全中心（已更名为 Microsoft Defender for Cloud）。  选择页面右上角的“**X**”，返回到“策略分配”页面。

1. 在页面顶部选择“**分配策略**”。

1. 这会打开分配策略向导，在分配策略的过程中向管理员提供指导。  选择“**策略定义**”字段旁的省略号。  此时会显示可用策略定义列表。  

1. 在搜索栏中，输入“**标记**”。

1. 在搜索结果中，选择“**要求资源组上带有标记**”（可能需要向下滚动才能看到），然后按“**选择**”。  备注：此策略的效果是拒绝创建任何不满足要求的新资源组。  

1. 记下默认分配名称。  保持名称不变，在页面底部选择“**下一步**”。

1. 在“标记名称”字段，输入“**环境**”（资源组将需要环境标记），然后选择“**下一步**”。  

1. 在“修正”选项卡中阅读描述，但不要更改设置。选择“**下一步**”

1. 在“不合规”消息中，输入“**需要环境标记**”，然后选择“**下一步**”。备注：对于在策略分配之前创建且没有环境标记的资源组，将显示此消息作为不合规的原因。  对于在策略创建后再创建的资源组，如果没有环境标记，将拒绝创建资源组。

1. 查看策略分配，然后选择“创建”。  如果未立即看到该策略，请选择“**刷新**”。备注：策略最多可能 30 分钟后就会生效。

1. 选择屏幕右上角的“**X**”，退出“策略分配”页面。

1. 现在位于 Azure 服务主页。  请将此页面保持在打开状态，在下一个任务中将用到它。

#### 演示第 2 部分：  创建一个不带标记的资源组来演示策略的影响，然后修复资源组，使其带有标记。

1. 在页面顶部显示 Azure 服务的位置下方，选择“**资源组**”。如果未看到选项列出，请在搜索栏中输入“资源组”，并从中进行选择。

1. 在页面左上角选择“**+ 创建**”。

1. 在“创建资源组”的“基本信息”选项卡中，保持“订阅”字段（Azure Pass - 赞助）不变。

1. 在“资源组”字段中输入“**SC900-Labs**”。

1. 将“区域”设置保留默认值，然后选择“**下一步: 标记**”。

1. 将标记的“名称”和“值”字段保留为空白。  请勿填充，然后选择“**查看 + 创建**”。

1. 你将看到验证通过（标记名称和值不是向导中的必填字段），然后选择“**创建**”。

1. 屏幕顶部将显示一条失败消息，指示“资源组创建失败。查看错误详细信息”。  选择“**查看错误详细信息**”。不满足该 Azure 策略包含的条件，因此资源组创建因不合规而遭到阻止。备注：如果没有看到失败消息，且资源组已创建，则原因是该策略尚未生效。  请转到“策略”页面，查看在上一任务中创建的策略；策略生效后，将看到该资源不合规。  详细信息页面将包含“不合规”消息。

1. 错误摘要显示错误类型“策略禁止使用资源 SC900-Labs”。  选择屏幕左上角的“**X**”关闭此窗口。

1. 在“创建资源组”窗口中，选择“**<上一步**”。

1. 这会回到创建资源组的“标记”页面。  在“名称”字段输入“环境”，在“值”字段输入“**SC900-Labs**”，然后选择“**下一步: 查看 + 创建 >**”。

1. 验证标记，然后选择“**创建**”。

1. 你将看到资源组被列出。  由于此标记是在该资源组中提供的，因此满足该 Azure 策略中包含的条件。  该资源组符合此策略。

#### 回顾

在本演示中，你演练了设置 Azure 策略的过程以及该策略的影响。
